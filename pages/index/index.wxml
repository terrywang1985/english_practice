<view class="index-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-mask" wx:if="{{loading}}">
    <view class="loading-content">
      <text class="loading-icon">â³</text>
      <text class="loading-text">æ­£åœ¨åŠ è½½å…³å¡...</text>
    </view>
  </view>

  <!-- é”™è¯¯æç¤º -->
  <view class="error-tip" wx:if="{{loadError && !loading}}">
    <text class="error-icon">âš ï¸</text>
    <text class="error-text">{{errorMsg}}</text>
    <button class="retry-btn" bindtap="loadGrades">é‡è¯•</button>
  </view>

  <!-- ç”¨æˆ·è¿›åº¦ä¿¡æ¯ -->
  <view class="progress-header" wx:if="{{!loading && userProgress}}">
    <view class="progress-info">
      <text class="progress-label">å½“å‰å…³å¡</text>
      <text class="progress-value">{{userProgress.currentGrade}} / {{grades.length}}</text>
    </view>
    <view class="progress-info">
      <text class="progress-label">æ€»å¾—åˆ†</text>
      <text class="progress-value">{{userProgress.totalScore}}</text>
    </view>
  </view>

  <!-- å…³å¡åˆ—è¡¨ -->
  <view class="grades-list" wx:if="{{!loading}}">
    <view 
      class="grade-card {{item.unlocked ? (item.completed ? 'completed' : 'unlocked') : 'locked'}}" 
      wx:for="{{grades}}" 
      wx:key="gradeId"
      bindtap="startGrade"
      data-id="{{item.gradeId}}"
    >
      <!-- å…³å¡å¤´éƒ¨ -->
      <view class="grade-header">
        <view class="grade-icon">{{item.icon}}</view>
        <view class="grade-info">
          <text class="grade-name">{{item.name}}</text>
          <text class="grade-desc">{{item.description}}</text>
        </view>
        <view class="grade-status">
          <text class="status-icon" wx:if="{{item.completed}}">âœ…</text>
          <text class="status-icon" wx:elif="{{!item.unlocked}}">ğŸ”’</text>
          <text class="status-icon" wx:else>â–¶ï¸</text>
        </view>
      </view>

      <!-- å…³å¡è¯¦æƒ… -->
      <view class="grade-details">
        <view class="detail-item">
          <text class="detail-label">é¢˜ç›®æ•°</text>
          <text class="detail-value">{{item.totalQuestions}}é¢˜</text>
        </view>
        <view class="detail-item" wx:if="{{item.score > 0}}">
          <text class="detail-label">å¾—åˆ†</text>
          <text class="detail-value">{{item.score}} / {{item.totalQuestions}}</text>
        </view>
        <view class="detail-item" wx:if="{{item.requiredScore > 0}}">
          <text class="detail-label">è§£é”æ¡ä»¶</text>
          <text class="detail-value">æ€»åˆ†â‰¥{{item.requiredScore}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
