# 服务器模式使用说明

## 🚀 快速启动

### 1. 启动题库服务器

双击运行 `start_server.bat` 文件，服务器会自动启动在 `http://127.0.0.1:8080`

服务器会：
- ✅ 自动监控 `data/questions.json` 文件变化
- ✅ 文件修改后自动重新加载题库
- ✅ 提供实时题库数据给小程序

### 2. 启动微信小程序

1. 打开微信开发者工具
2. 导入项目（选择当前目录）
3. 点击"编译"运行小程序

小程序会：
- ✅ 自动从服务器加载最新题库
- ✅ 如果服务器未启动，使用本地备份数据
- ✅ 显示加载状态和错误提示

## 📝 新增题目方法

### 方法一：修改 JSON 文件（推荐）

1. 确保服务器正在运行
2. 编辑 `data/questions.json` 文件
3. 添加新的题目对象到数组中
4. 保存文件
5. 服务器自动检测并重新加载
6. 小程序重新进入首页即可获取最新题库

### 示例：添加新题目

```json
{
  "id": "t10",
  "type": "conversion",
  "question": "单数：city",
  "options": ["citys", "cities", "cityes", "city's"],
  "correctAnswer": 1,
  "explanation": "city以辅音+y结尾，改y为i加es，复数为cities",
  "考点": "改y为i+es"
}
```

## 🔧 API 接口说明

### GET /api/questions

返回所有题目数据

**响应格式：**
```json
{
  "total": 18,
  "tags": ["改y为i+es", "不规则变化", "..."],
  "questions": [...],
  "version": "1730547234123456789"
}
```

### GET /api/version

返回当前题库版本号

**响应格式：**
```json
{
  "version": "1730547234123456789"
}
```

## ⚙️ 配置说明

### 修改服务器地址

如果需要修改服务器地址，编辑 `utils/questionManager.js` 文件：

```javascript
const API_BASE_URL = 'http://127.0.0.1:8080'; // 修改为你的服务器地址
```

### 修改服务器端口

编辑 `server.go` 文件最后一行：

```go
r.Run("127.0.0.1:8080") // 修改端口号
```

## 🎯 优势

1. **动态更新**：修改题目文件后无需重启小程序
2. **服务器监控**：自动检测文件变化，实时更新缓存
3. **离线备份**：服务器不可用时自动使用本地数据
4. **版本控制**：支持版本号管理，便于数据同步

## 💡 注意事项

1. 小程序开发时需要在 "详情 -> 本地设置" 中勾选 "不校验合法域名"
2. 正式发布需要配置合法的服务器域名
3. JSON 文件修改时注意格式正确，避免语法错误
4. 服务器日志会显示题库加载情况，方便调试
